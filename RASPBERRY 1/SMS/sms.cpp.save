#include <iostream>
#include <fstream>
#include <sstream>
#include <chrono>
#include <thread>
using namespace std;


string readFileIntoString(const string& path);

int main()
{
    //system("python3 receiver_modified.py");
    cout << "Début du programme" << endl;
    string nomfic("etat.txt");
    string etat;
    string ancien="on sait pas";
    etat = readFileIntoString(nomfic);
    cout << etat << endl;
    
    if (etat == "close" && ancien != "close")
    {
        cout << "fenetre fermée";
    }
    if (etat == "open" && ancien != "open")
    {
        cout << "fenetre ouverte";
        //system("sudo minicom -b 9600 -o -D /dev/ttyUSB0");
    }
    ancien = etat;
    std::this_thread::sleep_for(std::chrono::milliseconds(1000));
    //exit(EXIT_SUCCESS);
}

string readFileIntoString(const string& path) {
    ifstream input_file(path);
    if (!input_file.is_open()) {
        cerr << "Could not open the file - '"
             << path << "'" << endl;
        exit(EXIT_FAILURE);
    }
    return string((istreambuf_iterator<char>(input_file)), istreambuf_iterator<char>());
}

